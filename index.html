<script>
async function cargarProductos() {
  const response = await fetch('https://raw.githubusercontent.com/nahuriverfm/marketplace/main/_productos/productos.json'); 
  const data = await response.json(); 
  const productos = data.items; // <-- Ahora accedemos a "items"
  const cont = document.getElementById('productos');

  productos.forEach(p => {
    const imgPrincipal = p.imagenes && p.imagenes.length > 0 ? p.imagenes[0] : ''; // Primera imagen
    cont.innerHTML += `
      <div class="item ${p.categoria}">
        ${p.vendido ? '<div class="vendido">VENDIDO</div>' : ''}
        <h3>${p.titulo}</h3>
        <img src="img/productos/${imgPrincipal}" alt="${p.titulo}">
        <p class="descripcion">${p.descripcion}</p>
        <p class="precio">$${p.precio}</p>
        <div class="botones">
          <a class="btn-whatsapp" href="${p.vendido ? '#' : p.link}" target="_blank" ${p.vendido ? 'style="pointer-events:none;opacity:0.6;"' : ''}>WhatsApp</a>
          <button class="btn-vermas" onclick="openModal('${p.titulo}', '${p.descripcion}', '${p.precio}', ${JSON.stringify(p.imagenes)}, '${p.link}')">Ver más</button>
        </div>
      </div>
    `;
  });
}

function openModal(titulo, descripcion, precio, imagenes, link) {
  document.getElementById('modal').style.display = 'block';
  const modalImg = document.getElementById('modal-img');

  // Si hay varias imágenes, usamos la primera
  const imgPrincipal = imagenes && imagenes.length > 0 ? imagenes[0] : '';
  modalImg.src = 'img/productos/' + imgPrincipal;

  document.getElementById('modal-titulo').innerText = titulo;
  document.getElementById('modal-descripcion').innerText = descripcion;
  document.getElementById('modal-precio').innerText = '$' + precio;
  document.getElementById('modal-wpp').href = link;
}

cargarProductos();
</script>